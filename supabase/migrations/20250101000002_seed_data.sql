-- Insert sample deals data
INSERT INTO deals (title, company, contact_person, contact_email, contact_phone, amount, status, priority, probability, expected_close_date, description, area, product, team, notes, created_at, updated_at) VALUES
  ('新規CRMシステム導入', '株式会社テックソリューション', '山田太郎', 'yamada@techsol.co.jp', '03-1234-5678', 5000000, '商談中', '高', 70, '2025-12-15', '既存システムの老朽化に伴うCRM刷新案件', '関東', 'CRMシステム', '第一営業部', '来週デモ実施予定', '2025-10-01', '2025-11-15'),
  ('Webサイトリニューアル', 'マーケティング株式会社', '佐藤花子', 'sato@marketing.co.jp', '03-9876-5432', 2000000, '提案', '中', 50, '2025-12-30', 'コーポレートサイトの全面リニューアル', '関東', 'Webサイト制作', '第二営業部', NULL, '2025-10-15', '2025-11-10'),
  ('クラウドインフラ構築', '株式会社グローバルトレード', '鈴木一郎', 'suzuki@globaltrade.co.jp', '06-1111-2222', 8000000, '新規', '高', 30, '2026-01-31', 'AWS移行とマイクロサービス化', '関東', 'クラウドサービス', '第一営業部', '予算確保済み。技術的な課題をヒアリング中', '2025-11-01', '2025-11-17'),
  ('セキュリティ監視システム', '関西電機工業株式会社', '田中誠', 'tanaka@kansai-denki.co.jp', '06-2345-6789', 6500000, '商談中', '高', 65, '2026-01-15', '工場向けセキュリティ監視システムの導入', '関西', 'セキュリティソリューション', '西日本営業部', '工場視察完了、見積もり提出予定', '2025-10-20', '2025-11-16'),
  ('ECサイト構築', '大阪フーズ株式会社', '高橋美咲', 'takahashi@osaka-foods.co.jp', '06-3456-7890', 3500000, '提案', '中', 55, '2025-12-20', '食品ECサイトの新規構築', '関西', 'Webサイト制作', '西日本営業部', NULL, '2025-10-25', '2025-11-14'),
  ('データ分析プラットフォーム', '関西物流サービス', '渡辺健一', 'watanabe@kansai-logistics.co.jp', '06-4567-8901', 7000000, 'クロージング', '高', 85, '2025-11-30', '物流データの可視化と予測分析', '関西', 'データ分析基盤', '西日本営業部', '契約書レビュー中', '2025-09-15', '2025-11-17'),
  ('農業IoTシステム', '東北アグリテック株式会社', '伊藤拓也', 'ito@tohoku-agri.co.jp', '022-1234-5678', 4500000, '商談中', '中', 60, '2026-02-15', 'スマート農業向けIoTセンサーシステム', '東北', 'クラウドサービス', '第一営業部', '現地デモ実施予定', '2025-10-10', '2025-11-15'),
  ('観光アプリ開発', '仙台観光協会', '菅原由美', 'sugawara@sendai-tourism.jp', '022-2345-6789', 2800000, '成約', '中', 100, '2025-10-31', '地域観光ガイドアプリの開発', '東北', 'モバイルアプリ開発', '第二営業部', NULL, '2025-08-01', '2025-10-31'),
  ('製造業DXプロジェクト', '九州重工業株式会社', '中村浩二', 'nakamura@kyushu-heavy.co.jp', '092-1234-5678', 12000000, 'アプローチ中', '高', 40, '2026-03-31', '製造ラインのデジタル化推進', '九州', 'データ分析基盤', 'エンタープライズ営業部', '初回ヒアリング完了', '2025-11-05', '2025-11-17'),
  ('在庫管理システム', '福岡ロジスティクス', '小林恵子', 'kobayashi@fukuoka-logi.co.jp', '092-2345-6789', 3200000, '提案', '中', 50, '2026-01-20', '倉庫在庫のリアルタイム管理', '九州', 'CRMシステム', '第三営業部', NULL, '2025-10-28', '2025-11-16'),
  ('社内ポータル刷新', '九州電力グループ', '松本大輔', 'matsumoto@kyuden-g.co.jp', '092-3456-7890', 4800000, '商談中', '高', 70, '2026-02-28', 'グループ社内ポータルサイトの統合・刷新', '九州', 'Webサイト制作', 'エンタープライズ営業部', NULL, '2025-10-15', '2025-11-15'),
  ('観光予約システム', '北海道ツーリズム株式会社', '佐々木翔', 'sasaki@hokkaido-tourism.co.jp', '011-1234-5678', 3800000, 'クロージング', '高', 90, '2025-12-10', 'インバウンド向け予約プラットフォーム', '北海道', 'Webサイト制作', '第一営業部', '最終契約交渉中', '2025-09-20', '2025-11-17'),
  ('酪農データ管理', '十勝農業協同組合', '加藤正明', 'kato@tokachi-ja.or.jp', '0155-1234-5678', 5500000, '商談中', '中', 55, '2026-02-28', '酪農家向けデータ管理クラウドシステム', '北海道', 'クラウドサービス', '第一営業部', NULL, '2025-10-30', '2025-11-16'),
  ('自動車部品管理システム', '名古屋オートパーツ株式会社', '横山隆', 'yokoyama@nagoya-ap.co.jp', '052-1234-5678', 9000000, '提案', '高', 60, '2026-01-31', '部品在庫・発注の自動化システム', '中部', 'CRMシステム', '第三営業部', '競合他社との比較検討中', '2025-10-05', '2025-11-15'),
  ('スマートファクトリー化', '静岡精密機器株式会社', '青木智子', 'aoki@shizuoka-seimitsu.co.jp', '054-2345-6789', 15000000, 'アプローチ中', '高', 35, '2026-06-30', '製造工程の完全自動化・IoT化', '中部', 'データ分析基盤', 'エンタープライズ営業部', '要件定義ヒアリング開始', '2025-11-10', '2025-11-17'),
  ('モバイル勤怠管理', '中部建設株式会社', '井上慎一', 'inoue@chubu-kensetsu.co.jp', '052-3456-7890', 2500000, '成約', '中', 100, '2025-11-15', '現場作業員向け勤怠管理アプリ', '中部', 'モバイルアプリ開発', '第二営業部', NULL, '2025-09-01', '2025-11-15'),
  ('港湾物流最適化', '広島港運株式会社', '山本健太', 'yamamoto@hiroshima-port.co.jp', '082-1234-5678', 7500000, '商談中', '高', 65, '2026-02-15', '港湾コンテナ管理の最適化システム', '中国', 'データ分析基盤', '西日本営業部', '現地調査完了', '2025-10-12', '2025-11-16'),
  ('医療機関向けセキュリティ', '岡山医療センター', '藤田裕子', 'fujita@okayama-mc.jp', '086-2345-6789', 4200000, '提案', '中', 45, '2026-01-31', '医療情報セキュリティ強化', '中国', 'セキュリティソリューション', '第三営業部', NULL, '2025-10-22', '2025-11-15'),
  ('地方銀行CRM導入', '四国銀行', '石田康弘', 'ishida@shikoku-bank.co.jp', '088-1234-5678', 8500000, 'クロージング', '高', 80, '2025-12-20', '顧客管理・営業支援システムの刷新', '四国', 'CRMシステム', 'エンタープライズ営業部', '役員プレゼン完了、契約準備中', '2025-08-15', '2025-11-17'),
  ('農産物トレーサビリティ', '愛媛柑橘農業組合', '木村美穂', 'kimura@ehime-citrus.or.jp', '089-2345-6789', 3000000, '新規', '中', 25, '2026-03-31', '農産物の生産履歴管理システム', '四国', 'クラウドサービス', '第二営業部', '初回商談予定', '2025-11-12', '2025-11-17'),
  ('失注案件：人事システム', '東京メディア株式会社', '坂本健', 'sakamoto@tokyo-media.co.jp', '03-5678-1234', 4000000, '失注', '中', 0, '2025-10-31', '人事管理システムの提案', '関東', 'CRMシステム', '第一営業部', '競合に敗北', '2025-07-01', '2025-10-31'),
  ('モバイル営業支援アプリ', '関西不動産グループ', '岡田真一', 'okada@kansai-re.co.jp', '06-5678-9012', 3600000, '成約', '高', 100, '2025-11-20', '不動産営業担当者向けモバイルアプリ', '関西', 'モバイルアプリ開発', '西日本営業部', NULL, '2025-08-20', '2025-11-20'),
  ('コールセンターシステム', '東北テレコム株式会社', '遠藤直樹', 'endo@tohoku-telecom.co.jp', '022-3456-7890', 5200000, 'アプローチ中', '中', 45, '2026-03-15', 'コールセンター業務効率化システム', '東北', 'CRMシステム', '第三営業部', NULL, '2025-11-08', '2025-11-17'),
  ('Web会議システム連携', '北海道ITソリューションズ', '西村健太郎', 'nishimura@hokkaido-it.co.jp', '011-2345-6789', 1800000, '成約', '低', 100, '2025-10-15', '既存システムとWeb会議ツールの連携', '北海道', 'クラウドサービス', '第一営業部', NULL, '2025-09-01', '2025-10-15'),
  ('サプライチェーン可視化', '九州製薬株式会社', '川口由紀', 'kawaguchi@kyushu-pharma.co.jp', '092-4567-8901', 11000000, '提案', '高', 55, '2026-04-30', '医薬品サプライチェーンの可視化・最適化', '九州', 'データ分析基盤', 'エンタープライズ営業部', '技術検証フェーズ', '2025-10-18', '2025-11-16');

-- Link deals with tags (you'll need to update these UUIDs after tags are inserted)
-- This is a simplified version - you may want to adjust based on actual tag IDs
DO $$
DECLARE
  tag_important UUID;
  tag_urgent UUID;
  tag_large UUID;
  tag_existing UUID;
BEGIN
  -- Get tag IDs
  SELECT id INTO tag_important FROM tags WHERE name = '重要';
  SELECT id INTO tag_urgent FROM tags WHERE name = '至急';
  SELECT id INTO tag_large FROM tags WHERE name = '大口';
  SELECT id INTO tag_existing FROM tags WHERE name = '既存顧客';

  -- Insert deal_tags based on original mock data
  INSERT INTO deal_tags (deal_id, tag_id)
  SELECT d.id, tag_important FROM deals d WHERE d.title = '新規CRMシステム導入';

  INSERT INTO deal_tags (deal_id, tag_id)
  SELECT d.id, tag_large FROM deals d WHERE d.title = '新規CRMシステム導入';

  INSERT INTO deal_tags (deal_id, tag_id)
  SELECT d.id, tag_existing FROM deals d WHERE d.title = 'Webサイトリニューアル';

  INSERT INTO deal_tags (deal_id, tag_id)
  SELECT d.id, tag_important FROM deals d WHERE d.title = 'クラウドインフラ構築';

  INSERT INTO deal_tags (deal_id, tag_id)
  SELECT d.id, tag_urgent FROM deals d WHERE d.title = 'クラウドインフラ構築';

  INSERT INTO deal_tags (deal_id, tag_id)
  SELECT d.id, tag_large FROM deals d WHERE d.title = 'クラウドインフラ構築';
END $$;
